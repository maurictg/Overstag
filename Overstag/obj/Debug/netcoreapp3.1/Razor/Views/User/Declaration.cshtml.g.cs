#pragma checksum "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "d80cd5e06e726e7c0202894d05c1348f6f8d9ee7"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_User_Declaration), @"mvc.1.0.view", @"/Views/User/Declaration.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"d80cd5e06e726e7c0202894d05c1348f6f8d9ee7", @"/Views/User/Declaration.cshtml")]
    public class Views_User_Declaration : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<List<Overstag.Accountancy.Transaction>>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
  
    ViewBag.Title = "Declaraties";
    Layout = "_UserLayout";

#line default
#line hidden
#nullable disable
            WriteLiteral("<div>\r\n    <h2 class=\"blue-dark-text center-align\">Declaraties</h2>\r\n</div>\r\n\r\n");
#nullable restore
#line 10 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
 if (Model.Count() > 0)
{

#line default
#line hidden
#nullable disable
            WriteLiteral(@"    <table>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Ingediend op</th>
                <th>Bedrag</th>
                <th>Omschrijving</th>
                <th>Type</th>
                <th>Uitbetaald</th>
            </tr>
        </thead>
        <tbody>
");
#nullable restore
#line 24 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
             foreach (var d in Model)
            {

#line default
#line hidden
#nullable disable
            WriteLiteral("                <tr>\r\n                    <td>");
#nullable restore
#line 27 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                   Write(d.When.ToString("dd-MM-yyyy"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                    <td>");
#nullable restore
#line 28 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                   Write(d.Timestamp.ToString("dd-MM-yyyy"));

#line default
#line hidden
#nullable disable
            WriteLiteral(" om ");
#nullable restore
#line 28 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                                                          Write(d.Timestamp.ToString("HH:mm"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                    <td>&euro;");
#nullable restore
#line 29 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                         Write(Math.Round((double)d.Amount / 100, 2).ToString("F"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                    <td>");
#nullable restore
#line 30 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                   Write(d.Description);

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                    <td");
            BeginWriteAttribute("id", " id=\"", 933, "\"", 948, 2);
            WriteAttributeValue("", 938, "type-", 938, 5, true);
#nullable restore
#line 31 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
WriteAttributeValue("", 943, d.Id, 943, 5, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral("></td>\r\n                    <td>");
#nullable restore
#line 32 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                   Write(Html.Raw(Overstag.Services.Html.YesNo(d.Payed)));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                </tr>\r\n                <tr>\r\n                    <td colspan=\"6\" class=\"center-align photodata\" data-id=\"");
#nullable restore
#line 35 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                                                                       Write(d.Id);

#line default
#line hidden
#nullable disable
            WriteLiteral("\" data-json=\"");
#nullable restore
#line 35 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
                                                                                         Write(d.Metadata);

#line default
#line hidden
#nullable disable
            WriteLiteral("\">\r\n                        <p>Fotos niet ingeladen - <a href=\"#\" onclick=\"Payment.loadImages();\">Alles inladen</a></p>\r\n                    </td>\r\n                </tr>\r\n");
#nullable restore
#line 39 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
            }

#line default
#line hidden
#nullable disable
            WriteLiteral("        </tbody>\r\n    </table>\r\n");
#nullable restore
#line 42 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
}
else
{

#line default
#line hidden
#nullable disable
            WriteLiteral("    <h5 class=\"center-align\">Geen ingediende declaraties gevonden</h5>\r\n");
#nullable restore
#line 46 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
}

#line default
#line hidden
#nullable disable
            WriteLiteral(@"<br />
<br />
<div class=""center-align"">
    <a class=""btn btn-large waves-effect blue-dark"" id=""btnshow"" href=""#add"" onclick=""Payment.showField()"">Toevoegen</a>
</div>

<br />
<div id=""add"" class=""center-align"" style=""display: none; border: 1px solid black;"">
    <br />
    <h4>Declaratie indienen</h4>
    <p>Beantwoord de volgende vragen:</p>
    <br />
    <div class=""row"">
        <div class=""input-field col m6 offset-m3 s12"">
            <input id=""when"" type=""text"" class=""datepicker validate"">
            <label for=""when"">1. Wanneer heeft u de kosten gemaakt?</label>
            <span class=""helper-text"" data-error=""Vul a.u.b. een datum in""></span>
        </div>
        <div class=""input-field col m6 offset-m3 s12"">
            <input id=""amount"" type=""text"" class=""validate"">
            <label for=""amount"">2. Wat is het bedrag in â‚¬</label>
            <span class=""helper-text"" data-error=""Vul a.u.b. een bedrag in (kommagetal, 2 decimalen)""></span>
        </div>
        <div cl");
            WriteLiteral(@"ass=""input-field col m6 offset-m3 s12"">
            <textarea id=""desc"" type=""text"" class=""validate materialize-textarea""></textarea>
            <label for=""desc"">3. Omschrijving</label>
            <span class=""helper-text"" data-error=""Vul a.u.b. een omschrijving in""></span>
        </div>
        <div class=""input-field col m6 offset-m3 s12"">
            <p>Voeg eventueel een kassabon toe</p>
            <div class=""file-field input-field"">
                <div class=""btn"">
                    <span>Toevoegen</span>
                    <input type=""file"" id=""files"" multiple>
                </div>
                <div class=""file-path-wrapper"">
                    <input class=""file-path"" id=""filestext"" type=""text"" placeholder=""Upload 1 of meer foto's"">
                </div>
            </div>
        </div>
        <div class=""col s12"">
            Type:
            <p>
                <label>
                    <input class=""with-gap"" value=""Brandstof"" name=""type"" type=""radio"" chec");
            WriteLiteral(@"ked=""checked"" />
                    <span>Brandstof</span>
                </label>
            </p>
            <p>
                <label>
                    <input class=""with-gap"" value=""Boodschappen"" name=""type"" type=""radio"" />
                    <span>Boodschappen</span>
                </label>
            </p>
            <p>
                <label>
                    <input class=""with-gap"" value=""Activiteiten"" name=""type"" type=""radio"" />
                    <span>Activiteiten</span>
                </label>
            </p>
            <p>
                <label>
                    <input class=""with-gap"" value=""Overige"" name=""type"" type=""radio"" />
                    <span>Overige</span>
                </label>
            </p>
        </div>
        <div class=""col m6 offset-m3 s12"">
            <p>
                <label>
                    <input type=""checkbox"" id=""check"" class=""filled-in"" />
                    <span>Ik heb alles naar waarheid ingevuld</span>");
            WriteLiteral(@"
                </label>
            </p>
        </div>
    </div>
    <button class=""btn waves-effect"" onclick=""Payment.hideField();"">Annuleren</button>
    <button class=""btn green waves-effect disabled"" id=""btnsend"" onclick=""Payment.startPost();"">Verzenden</button>
    <br />
    <br />
</div>


<script>
    var done = false;

    var Payment = {
        init: function () {
            $('#_apay, #_mapay').addClass('active');
            $('#check').prop('checked', false);
            Payment.mapEvents();
            Payment.loadTypes();
        },
        mapEvents: function () {
            $('#check').change(function () {
                if (this.checked) {
                    $('#btnsend').removeClass('disabled');
                } else {
                    $('#btnsend').addClass('disabled');
                }
            });
        },
        loadTypes: function () {
            $.each($('.photodata'), function (i, e) {
                $('#type-' + $(e).data('id')).");
            WriteLiteral(@"html($(e).data('json').type);
            });
        },
        loadImages: function () {
            $.each($('.photodata'), function (i, e) {
                var html = '<div class=""row"">';
                var json = $(e).data('json')
                if (json.files != '') {
                    var files = json.files.split(',');
                    $.each(files, function (i, e) {
                        html += `<img src=""/Files/Serve/${encodeURIComponent(e)}"" class=""materialboxed col s3 m2""/>`
                    });
                } else {
                    html += '<i>Geen foto\'s geupload</i>'
                }
                $(e).html(html + '</row>');
            });
            $('.materialboxed').materialbox();
        },
        showField: function () {
            $('#add').show();
            $('#btnshow').hide();
        },
        hideField: function () {
            $('#add').hide();
            $('#btnshow').show();
        },
        validate: function () {
  ");
            WriteLiteral(@"          var valid = true;
            if (!/^([0-9]*),([0-9][0-9])/.test($('#amount').val())) {
                $('#amount').addClass(""invalid"");
                $('#amount').prop(""aria-invalid"", ""true"");
                valid = false;
            }
            $.each($('.validate'), function (i, e) {
                if ($(e).val() == '') {
                    $(e).addClass(""invalid"");
                    $(e).prop(""aria-invalid"", ""true"");
                    valid = false;
                }
            });
            return valid;
        },
        startPost: function () {
            if (Payment.validate()) {
                $(window).scrollTop(0);
                $('#_progbar').show();
                Payment.hideField();
                $('#btnshow').addClass('disabled');
                if ($(""#files"").prop('files').length > 0) {
                    M.toast({ html: 'Uploaden....' });
                    $('#_progbar div').removeClass('indeterminate').addClass('determinate');
 ");
            WriteLiteral(@"                   $('#_progbar div').css('width', '0%');
                    Payment.uploadPhotos(Payment.post);
                } else {
                    Payment.post();
                }
            }
        },
        post: function (fileids) {
            var files = '';
            if (fileids != undefined)
                files = fileids.join(',');

            var data = {
                When: $('#when').val(),
                Amount: Math.round(Number($('#amount').val().replace("","", ""."")) * 100),
                Description: $('#desc').val(),
                Metadata: JSON.stringify({ type: $(""input[name='type']:checked"").val(), files: files })
            };

            $.post('/User/postDeclaration', data, function (r) {
                if (r.status == 'success') {
                    M.toast({ html: 'Successvol ingediend!', classes: 'green' });
                    Core.doReload(500);
                } else {
                    M.toast({ html: r.error, classes: 'red' ");
            WriteLiteral(@"});
                }
            }).done(function () {
                $('.validate').val('');
                $('#files, #filestext').val('');
                $('#_progbar').hide();
            });
        },
        uploadPhotos: function (_callback) {
            var formdata = new FormData();
            $.each($('#files').prop('files'), function (i, e) {
                formdata.append('files', e);
            });

            $.ajax({
                url: '/Files/uploadFiles',
                type: ""POST"",
                data: formdata,
                processData: false,
                contentType: false,
                xhr: function () {
                    var mxhr = $.ajaxSettings.xhr();
                    if (mxhr.upload) {
                        mxhr.upload.addEventListener('progress', progress, false);
                    }
                    return mxhr;
                },
                success: function (response) {
                    if (response.status ==");
            WriteLiteral(@"= ""success"") {
                        M.toast({ html: 'Foto\'s geupload!', classes: 'blue' });
                        _callback(response.fileIDS);
                    }
                },
                error: function () {
                    M.toast({ html: 'Error: Uw foto kon niet geupload worden', classes: 'red' });
                    $('#_progbar div').removeClass('determinate').addClass('indeterminate');
                    $('#btnshow').removeClass('disabled');
                    $('#_progbar').hide();
                    done = true;
                },
                done: function () {
                    $('#_progbar div').removeClass('determinate').addClass('indeterminate');
                    $('#btnshow').removeClass('disabled');
                    done = true;
                }
            });
        }
    }

    function progress(e) {
        if (e.lengthComputable && !done) {
            var max = e.total;
            var current = e.loaded;
            var Pe");
            WriteLiteral(@"rcentage = Math.round((current * 100) / max);
            console.log(""Uploaded: "" + current + "" out of "" + max);
            $('#_progbar div').css('width', `${Percentage}%`);
        }
    }

    $(function () {
        $('.datepicker').datepicker({
            format: 'dd-mm-yyyy'
        });

        Payment.init();


    });
</script>

");
#nullable restore
#line 297 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
 if (Model.Count() < 5)
{

#line default
#line hidden
#nullable disable
            WriteLiteral("    <script>\r\n        Payment.loadImages();\r\n    </script>\r\n");
#nullable restore
#line 302 "C:\Users\mauri\Documents\GitHub\Overstag\Overstag\Views\User\Declaration.cshtml"
}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<List<Overstag.Accountancy.Transaction>> Html { get; private set; }
    }
}
#pragma warning restore 1591
